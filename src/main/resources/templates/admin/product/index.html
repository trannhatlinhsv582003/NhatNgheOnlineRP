<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<link rel="shortcut icon" type="x-icon" th:href="@{/images/logo/logo.png}">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Quản lý sản phẩm</title>

	<!-- Bootstrap -->
	<link rel="stylesheet" th:href="@{/libraries/bootstrap-5.3.3-dist/css/bootstrap.min.css}">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

	<!-- CSS Custom -->
	<link rel="stylesheet" th:href="@{/css/app.css}">
</head>

<body>

	<!-- HEADER -->
	<header class="row">
		<div th:replace="/components/_menu.html"></div>
	</header>

	<!-- BODY -->
	<div class="container-fluid">
		<div class="row">
			<!-- Sidebar -->
			<div th:replace="/components/_adminSidebar.html"></div>

			<!-- Main content -->
			<main class="col-md-10 ms-sm-auto px-4">
				<div class="container-fluid">
					<div class="pt-4">
						<h3 class="fw-bold mb-3">Quản lý sản phẩm</h3>
						<ul class="nav nav-tabs" id="productTab" role="tablist">
							<li class="nav-item">
								<button class="nav-link text-black active" id="list-tab" data-bs-toggle="tab"
									data-bs-target="#list" type="button" role="tab">Danh sách sản phẩm</button>
							</li>
							<li class="nav-item">
								<button class="nav-link text-black" id="form-tab" data-bs-toggle="tab"
									data-bs-target="#form" type="button" role="tab">Form sản phẩm</button>
							</li>
						</ul>
						<div class="tab-content p-3 mb-3 rounded bg-white" id="productTabContent">
							<!-- Tab Danh sách -->
							<div class="tab-pane fade show active" id="list" role="tabpanel">
								<div th:replace="/admin/product/_list.html"></div>
							</div>
							<!-- Tab Form -->
							<div class="tab-pane fade" id="form" role="tabpanel">
								<div th:replace="/admin/product/_form.html"></div>
							</div>
						</div>
					</div>
			</main>
		</div>
	</div>

	<!-- FOOTER -->
	<div th:replace="components/_footer.html"></div>

	<script th:src="@{/libraries/bootstrap-5.3.3-dist/js/bootstrap.bundle.min.js}"></script>
</body>

</html>

<script>
	document.addEventListener('DOMContentLoaded', function () {
		document.querySelectorAll('.btn-edit').forEach(function (btn) {
			btn.addEventListener('click', function () {
				const row = this.closest('tr');
				const id = row.getAttribute('data-id');

				fetch('/admin/product/api/' + id)
					.then(res => res.json())
					.then(data => {
						// Đổ dữ liệu vào form
						document.querySelector('#productID').value = data.productID;
						document.querySelector('[name=productName]').value = data.productName;
						document.querySelector('[name="category.categoryID"]').value = data.category.categoryID;
						document.querySelector('[name=brandName]').value = data.brandName;
						document.querySelector('[name=price]').value = data.price;
						document.querySelector('[name=stockQuantity]').value = data.stockQuantity;
						document.querySelector('[name=description]').value = data.description;
						document.querySelector('[name=specifications]').value = data.specifications;

						// Chuyển tab
						const tab = new bootstrap.Tab(document.querySelector('#form-tab'));
						tab.show();
					});
			});
		});
	});
</script>