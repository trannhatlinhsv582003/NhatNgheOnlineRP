<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<link rel="shortcut icon" type="x-icon" th:href="@{/images/logo/logo.png}">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Trang quản trị - Nhất Nghệ Online</title>

	<!-- Bootstrap -->
	<link rel="stylesheet" th:href="@{/libraries/bootstrap-5.3.3-dist/css/bootstrap.min.css}">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

	<!-- CSS Custom -->
	<link rel="stylesheet" th:href="@{/css/app.css}">
</head>

<body>

	<!-- HEADER -->
	<header class="row">
		<div th:replace="/components/_menu.html"></div>
	</header>

	<!-- BODY -->
	<div class="container-fluid">
		<div class="row">
			<!-- Sidebar -->
			<div th:replace="/components/_adminSidebar.html"></div>

			<!-- Main content -->
			<main class="col-md-10 ms-sm-auto px-4 mb-5">
				<div class="pt-4">
					<h3 class="fw-bold mb-4">Bảng điều khiển</h3>

					<!-- Row 1: Tổng quan -->
					<div class="row g-4 mb-4">
						<div class="col-md-4">
							<div
								class="bg-primary text-white rounded shadow-sm p-4 d-flex justify-content-between align-items-center">
								<div>
									<h5 class="fw-bold">Tổng doanh thu</h5>
									<h3 th:text="${#numbers.formatDecimal(totalRevenue, 0, 'COMMA', 0, 'POINT')} + '₫'">
										0₫</h3>
								</div>
								<i class="bi bi-cash-stack display-4"></i>
							</div>
						</div>

						<div class="col-md-4">
							<div
								class="bg-success text-white rounded shadow-sm p-4 d-flex justify-content-between align-items-center">
								<div>
									<h5 class="fw-bold">Tổng sản phẩm đã bán</h5>
									<h3 th:text="${totalSoldProducts}">0</h3>
								</div>
								<i class="bi bi-box-seam display-4"></i>
							</div>
						</div>
						<div class="col-md-4">
							<div
								class="bg-danger text-white rounded shadow-sm p-4 d-flex justify-content-between align-items-center">
								<div>
									<h5 class="fw-bold">Tổng sản phẩm đã hủy</h5>
									<h3 th:text="${totalCancelledProducts}">0</h3>
								</div>
								<i class="bi bi-box-seam display-4"></i>
							</div>
						</div>
					</div>

					<!-- Row 2: Top bán chạy + đánh giá gần đây -->
					<div class="row g-4">
						<div class="col-md-6">
							<!-- Chart -->
							<div th:replace="components/_chart :: chart"></div>

							<!-- Đánh giá gần đây -->
							<div class="bg-white rounded shadow-sm p-4">
								<h5 class="fw-bold mb-3">Đánh giá gần đây</h5>
								<ul class="list-group list-group-flush">
									<li class="list-group-item px-0 py-2" th:each="r : ${recentReviews}">
										<div class="d-flex justify-content-between">
											<div>
												<strong th:text="${r.user.fullName}">Tên</strong>
												<span class="ms-2 text-warning small">
													<i class="bi bi-star-fill"
														th:each="i : ${#numbers.sequence(1, r.rating)}"></i>
												</span>
											</div>

											<small class="text-muted" th:text="${r.createdAt}">Hôm nay</small>
										</div>
										<div class="text-muted small" th:text="${r.comment}">Bình luận</div>
									</li>
									<li class="list-group-item text-muted text-center"
										th:if="${#lists.isEmpty(recentReviews)}">
										Chưa có đánh giá nào
									</li>
								</ul>
							</div>
						</div>

						<!-- Top sản phẩm bán chạy -->
						<div class="col-md-6">
							<div class="bg-white rounded shadow-sm p-4">
								<h5 class="fw-bold mb-3">Top 10 sản phẩm bán chạy</h5>
								<table class="table table-hover">
									<thead>
										<tr>
											<th>#</th>
											<th>Ảnh</th>
											<th>Tên sản phẩm</th>
											<th>Đã bán</th>
										</tr>
									</thead>
									<tbody>
										<tr th:each="p, iterStat : ${topSellingProducts}">
											<td th:text="${iterStat.index + 1}">1</td>
											<td><img th:src="@{'/images/products/' + ${p.imageURL}}" width="50"
													class="rounded" alt=""></td>
											<td class="align-middle">
												<a th:href="@{'/product/detail/' + ${p.productID}}"
													th:text="${p.productName}"
													class="text-decoration-none text-dark fw-medium">
													Sản phẩm
												</a>
											</td>

											<td th:text="${p.soldQuantity}">0</td>
										</tr>
										<tr th:if="${#lists.isEmpty(topSellingProducts)}">
											<td colspan="4" class="text-muted text-center">Chưa có dữ liệu</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>

					</div>
				</div>

			</main>
		</div>
	</div>

	<!-- FOOTER -->
	<div th:replace="components/_footer.html"></div>

	<script th:src="@{/libraries/bootstrap-5.3.3-dist/js/bootstrap.bundle.min.js}"></script>
</body>

</html>